<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cart Test - Product List Skin</title>
    <link rel="stylesheet" href="./dist/product-list-skin.css">
    <style>
        body { margin: 0; padding: 20px; font-family: sans-serif; background: #f5f5f5; }
        .container { background: white; padding: 20px; border-radius: 8px; }
        .test-log { margin-top: 20px; padding: 15px; background: #f0f0f0; border-radius: 5px; }
        .test-log h3 { margin-top: 0; }
        .log-entry { padding: 5px 0; border-bottom: 1px solid #ddd; font-size: 14px; }
        .log-entry:last-child { border-bottom: none; }
        .success { color: #28a745; }
        .error { color: #dc3545; }
    </style>
</head>
<body>
    <div class="container">
        <h1>장바구니 테스트</h1>
        <p>장바구니 버튼을 클릭해보세요. 페이지가 하얗게 변하지 않고 그대로 유지되어야 합니다.</p>
        
        <div id="product-list-root"></div>
        
        <div class="test-log">
            <h3>테스트 로그</h3>
            <div id="log-container"></div>
        </div>
    </div>
    
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="./dist/product-list-skin.umd.js"></script>
    
    <script>
        const logContainer = document.getElementById('log-container');
        
        function addLog(message, type = 'info') {
            const entry = document.createElement('div');
            entry.className = `log-entry ${type}`;
            entry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            logContainer.insertBefore(entry, logContainer.firstChild);
        }
        
        // 테스트 데이터
        const testData = {
            products: [
                {
                    id: 1,
                    name: '테스트 상품 1',
                    price: 45000,
                    originalPrice: 50000,
                    discountPercent: 10,
                    image: 'https://via.placeholder.com/400x400/89a1be/ffffff?text=Product+1',
                    rating: 4.5,
                    reviewCount: 24,
                    badges: ['BEST', 'ECO'],
                    isInStock: true,
                    stockCount: 10
                },
                {
                    id: 2,
                    name: '테스트 상품 2',
                    price: 25000,
                    image: 'https://via.placeholder.com/400x400/89a1be/ffffff?text=Product+2',
                    rating: 4.8,
                    reviewCount: 15,
                    badges: ['NEW'],
                    isInStock: true,
                    stockCount: 5
                }
            ],
            totalProducts: 2,
            currentPage: 1,
            totalPages: 1,
            loading: false,
            showStock: true
        };
        
        // 액션 핸들러
        const testActions = {
            handleAddToCart: (product) => {
                addLog(`장바구니에 추가됨: ${product.name} (ID: ${product.id})`, 'success');
                // 페이지가 하얗게 변하거나 이동하는지 확인
                setTimeout(() => {
                    if (document.body.style.display === 'none' || window.location.href !== document.URL) {
                        addLog('❌ 오류: 페이지가 변경되었습니다!', 'error');
                    } else {
                        addLog('✅ 성공: 페이지가 그대로 유지되었습니다!', 'success');
                    }
                }, 100);
            },
            handlePageChange: (page) => {
                addLog(`페이지 변경: ${page}`);
            }
        };
        
        // 유틸리티
        const testUtils = {
            t: (text) => text,
            formatCurrency: (price) => `${price.toLocaleString()}원`,
            navigate: (path) => {
                addLog(`상품 상세 페이지로 이동: ${path}`);
            }
        };
        
        // 옵션
        const testOptions = {
            showPrice: true,
            showAddToCart: true,
            showPagination: true,
            enableInfiniteScroll: false,
            buttonColor: '#89a1be'
        };
        
        // 컴포넌트 렌더링
        const container = document.getElementById('product-list-root');
        const root = ReactDOM.createRoot(container);
        
        addLog('ProductListSkin 컴포넌트 렌더링 시작');
        
        root.render(
            React.createElement(window.ProductListSkin, {
                data: testData,
                actions: testActions,
                utils: testUtils,
                options: testOptions
            })
        );
        
        addLog('ProductListSkin 컴포넌트 렌더링 완료');
        
        // 페이지 상태 모니터링
        let originalUrl = window.location.href;
        setInterval(() => {
            if (window.location.href !== originalUrl) {
                addLog('⚠️ 경고: URL이 변경되었습니다!', 'error');
                originalUrl = window.location.href;
            }
        }, 500);
    </script>
</body>
</html>